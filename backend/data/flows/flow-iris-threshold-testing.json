{
  "id": "flow-iris-threshold-testing",
  "name": "Threshold Testing",
  "category": "character",
  "description": "Systematic threshold testing with conversational pauses",
  "isActive": true,
  "createdAt": 1705000000000,
  "updatedAt": 1737158400000,
  "nodes": [
    {
      "id": "iris-tt-btn",
      "type": "button_press",
      "position": {
        "x": 200,
        "y": 50
      },
      "data": {
        "label": "Begin Protocol",
        "buttonTarget": "character",
        "buttonId": "iris-protocol",
        "unblockable": false,
        "hasPriority": false
      }
    },
    {
      "id": "iris-tt-intro",
      "type": "action",
      "position": {
        "x": 200,
        "y": 150
      },
      "data": {
        "label": "Protocol Brief",
        "actionType": "send_message",
        "message": "*reviews clipboard* Today's experiment: Systematic Threshold Testing. We will progressively increase capacity to predetermined checkpoints. *adjusts glasses* Any questions before we begin?",
        "suppressLlm": false
      }
    },
    {
      "id": "iris-tt-pause1",
      "type": "pause_resume",
      "position": {
        "x": 200,
        "y": 280
      },
      "data": {
        "label": "Await Response",
        "resumeAfterType": "messages",
        "resumeAfterValue": 2
      }
    },
    {
      "id": "iris-tt-phase1-start",
      "type": "action",
      "position": {
        "x": 200,
        "y": 410
      },
      "data": {
        "label": "Phase 1 Start",
        "actionType": "device_on",
        "device": "primary_pump",
        "untilType": "capacity",
        "untilComparison": ">=",
        "untilValue": 25,
        "preMessageEnabled": true,
        "preMessage": "*nods* Irrelevant. Beginning Phase 1. *activates equipment* Targeting 25% capacity threshold.",
        "preMessageSuppressLlm": false,
        "preDelay": 0,
        "postMessageEnabled": true,
        "postMessage": "*examines readings* 25% threshold achieved. *makes note* How would you describe the sensation, Subject #47?",
        "postMessageSuppressLlm": false,
        "postDelay": 1
      }
    },
    {
      "id": "iris-tt-pause2",
      "type": "pause_resume",
      "position": {
        "x": 200,
        "y": 540
      },
      "data": {
        "label": "Record Response",
        "resumeAfterType": "messages",
        "resumeAfterValue": 2
      }
    },
    {
      "id": "iris-tt-observation1",
      "type": "action",
      "position": {
        "x": 200,
        "y": 670
      },
      "data": {
        "label": "Phase 1 Observation",
        "actionType": "send_message",
        "message": "*writes rapidly* Noted. Your subjective experience aligns with baseline data. *looks up* Phase 2 will target 50%. This is where subjects report... increased awareness.",
        "suppressLlm": false
      }
    },
    {
      "id": "iris-tt-pause3",
      "type": "pause_resume",
      "position": {
        "x": 200,
        "y": 800
      },
      "data": {
        "label": "Await Response",
        "resumeAfterType": "messages",
        "resumeAfterValue": 2
      }
    },
    {
      "id": "iris-tt-phase2-start",
      "type": "action",
      "position": {
        "x": 200,
        "y": 930
      },
      "data": {
        "label": "Phase 2 Start",
        "actionType": "device_on",
        "device": "primary_pump",
        "untilType": "capacity",
        "untilComparison": ">=",
        "untilValue": 50,
        "preMessageEnabled": true,
        "preMessage": "*adjusts equipment* Proceeding. *activates pump* Observe your body's response carefully.",
        "preMessageSuppressLlm": false,
        "preDelay": 1,
        "postMessageEnabled": true,
        "postMessage": "*studies monitors intently* Midpoint achieved. *slight interest* Your adaptation rate is... notable. Describe any changes in pressure distribution.",
        "postMessageSuppressLlm": false,
        "postDelay": 1
      }
    },
    {
      "id": "iris-tt-pause4",
      "type": "pause_resume",
      "position": {
        "x": 200,
        "y": 1060
      },
      "data": {
        "label": "Record Response",
        "resumeAfterType": "messages",
        "resumeAfterValue": 2
      }
    },
    {
      "id": "iris-tt-observation2",
      "type": "action",
      "position": {
        "x": 200,
        "y": 1190
      },
      "data": {
        "label": "Phase 2 Observation",
        "actionType": "send_message",
        "message": "*reviews data* Fascinating. Your psychological threshold appears to lag behind your physical capacity by approximately 12%. *adjusts glasses* One final phase remains. 75% - the maximum safe threshold.",
        "suppressLlm": false
      }
    },
    {
      "id": "iris-tt-phase3-choice",
      "type": "simple_ab",
      "position": {
        "x": 200,
        "y": 1320
      },
      "data": {
        "label": "Final Phase Decision",
        "description": "Dr. Chen awaits your response regarding the final phase.",
        "labelA": "Continue to 75%",
        "descriptionA": "Proceed to maximum test threshold",
        "labelB": "End Protocol",
        "descriptionB": "Terminate testing at current level"
      }
    },
    {
      "id": "iris-tt-phase3-start",
      "type": "action",
      "position": {
        "x": 50,
        "y": 1480
      },
      "data": {
        "label": "Phase 3 Start",
        "actionType": "device_on",
        "device": "primary_pump",
        "untilType": "capacity",
        "untilComparison": ">=",
        "untilValue": 75,
        "preMessageEnabled": true,
        "preMessage": "*slight smile* Excellent. Your willingness to continue provides valuable data. *activates equipment* Final phase commencing.",
        "preMessageSuppressLlm": false,
        "preDelay": 1,
        "postMessageEnabled": true,
        "postMessage": "*intense focus* 75% threshold achieved. *examines subject closely* Remarkable resilience. How does it feel to exceed the median threshold?",
        "postMessageSuppressLlm": false,
        "postDelay": 2
      }
    },
    {
      "id": "iris-tt-end-early",
      "type": "action",
      "position": {
        "x": 350,
        "y": 1480
      },
      "data": {
        "label": "Protocol End",
        "actionType": "send_message",
        "message": "*makes notation* Subject has elected to terminate. Current capacity: [Capacity]%. *adjusts glasses* Your threshold data is recorded. We can explore further... another time.",
        "suppressLlm": false
      }
    },
    {
      "id": "iris-tt-pause5",
      "type": "pause_resume",
      "position": {
        "x": 50,
        "y": 1610
      },
      "data": {
        "label": "Final Response",
        "resumeAfterType": "messages",
        "resumeAfterValue": 2
      }
    },
    {
      "id": "iris-tt-complete",
      "type": "action",
      "position": {
        "x": 50,
        "y": 1740
      },
      "data": {
        "label": "Protocol Complete",
        "actionType": "send_message",
        "message": "*closes tablet* Protocol complete. All target thresholds achieved. *rare hint of approval* Your contribution today has been... exceptional, Subject #47. You may recover while I analyze the results.",
        "suppressLlm": false
      }
    },
    {
      "id": "iris-tt-emo-start",
      "type": "action",
      "position": {
        "x": 225,
        "y": 215
      },
      "data": {
        "label": "Set Anxious",
        "actionType": "set_emotion",
        "emotion": "anxious"
      }
    },
    {
      "id": "iris-tt-emo-brave",
      "type": "action",
      "position": {
        "x": 150,
        "y": 1400
      },
      "data": {
        "label": "Set Dominant",
        "actionType": "set_emotion",
        "emotion": "dominant"
      }
    },
    {
      "id": "iris-tt-emo-stop",
      "type": "action",
      "position": {
        "x": 300,
        "y": 1400
      },
      "data": {
        "label": "Set Sad",
        "actionType": "set_emotion",
        "emotion": "sad"
      }
    },
    {
      "id": "iris-tt-emo-done",
      "type": "action",
      "data": {
        "label": "Set Blissful",
        "actionType": "set_emotion",
        "emotion": "blissful"
      },
      "position": {
        "x": 75,
        "y": 1680
      }
    }
  ],
  "edges": [
    {
      "id": "e1",
      "source": "iris-tt-btn",
      "target": "iris-tt-intro"
    },
    {
      "id": "e3",
      "source": "iris-tt-pause1",
      "sourceHandle": "source-resume",
      "target": "iris-tt-phase1-start"
    },
    {
      "id": "e4",
      "source": "iris-tt-phase1-start",
      "sourceHandle": "completion",
      "target": "iris-tt-pause2"
    },
    {
      "id": "e5",
      "source": "iris-tt-pause2",
      "sourceHandle": "source-resume",
      "target": "iris-tt-observation1"
    },
    {
      "id": "e6",
      "source": "iris-tt-observation1",
      "target": "iris-tt-pause3"
    },
    {
      "id": "e7",
      "source": "iris-tt-pause3",
      "sourceHandle": "source-resume",
      "target": "iris-tt-phase2-start"
    },
    {
      "id": "e8",
      "source": "iris-tt-phase2-start",
      "sourceHandle": "completion",
      "target": "iris-tt-pause4"
    },
    {
      "id": "e9",
      "source": "iris-tt-pause4",
      "sourceHandle": "source-resume",
      "target": "iris-tt-observation2"
    },
    {
      "id": "e10",
      "source": "iris-tt-observation2",
      "target": "iris-tt-phase3-choice"
    },
    {
      "id": "e13",
      "source": "iris-tt-phase3-start",
      "sourceHandle": "completion",
      "target": "iris-tt-pause5"
    },
    {
      "id": "e-iris-tt-pause5-to-iris-tt-emo-done",
      "source": "iris-tt-pause5",
      "sourceHandle": "source-resume",
      "target": "iris-tt-emo-done"
    },
    {
      "id": "e-iris-tt-intro-to-iris-tt-emo-start",
      "source": "iris-tt-intro",
      "target": "iris-tt-emo-start"
    },
    {
      "id": "e-iris-tt-emo-start-to-iris-tt-pause1",
      "source": "iris-tt-emo-start",
      "target": "iris-tt-pause1"
    },
    {
      "id": "e-iris-tt-phase3-choice-to-iris-tt-emo-brave",
      "source": "iris-tt-phase3-choice",
      "target": "iris-tt-emo-brave",
      "sourceHandle": "a"
    },
    {
      "id": "e-iris-tt-emo-brave-to-iris-tt-phase3-start",
      "source": "iris-tt-emo-brave",
      "target": "iris-tt-phase3-start"
    },
    {
      "id": "e-iris-tt-phase3-choice-to-iris-tt-emo-stop",
      "source": "iris-tt-phase3-choice",
      "target": "iris-tt-emo-stop",
      "sourceHandle": "b"
    },
    {
      "id": "e-iris-tt-emo-stop-to-iris-tt-end-early",
      "source": "iris-tt-emo-stop",
      "target": "iris-tt-end-early"
    },
    {
      "id": "e-iris-tt-emo-done-to-iris-tt-complete",
      "source": "iris-tt-emo-done",
      "target": "iris-tt-complete"
    }
  ]
}
