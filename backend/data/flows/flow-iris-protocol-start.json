{
  "id": "flow-iris-protocol-start",
  "name": "Dr. Chen's Protocol Auto-Start",
  "category": "character",
  "description": "First player message triggers protocol selection",
  "isActive": true,
  "createdAt": 1737158400000,
  "updatedAt": 1737158400000,
  "nodes": [
    {
      "id": "iris-ps-trigger",
      "type": "trigger",
      "position": {
        "x": 250,
        "y": 50
      },
      "data": {
        "label": "First Player Message",
        "triggerType": "first_message",
        "unblockable": false,
        "notify": false,
        "hasPriority": false
      }
    },
    {
      "id": "iris-ps-selection",
      "type": "action",
      "position": {
        "x": 250,
        "y": 180
      },
      "data": {
        "label": "Protocol Selection",
        "actionType": "send_message",
        "message": "*glances at clipboard, then back at you* Noted. *adjusts glasses* The randomization algorithm has selected today's protocol. Your input is... not required.",
        "suppressLlm": false,
        "preMessageEnabled": false,
        "postMessageEnabled": false,
        "postDelay": 2
      }
    },
    {
      "id": "iris-ps-random",
      "type": "branch",
      "position": {
        "x": 250,
        "y": 320
      },
      "data": {
        "label": "Select Protocol",
        "branchType": "random",
        "branches": [
          {
            "id": "data",
            "label": "Data Collection",
            "weight": 33
          },
          {
            "id": "capacity",
            "label": "Capacity Study",
            "weight": 34
          },
          {
            "id": "threshold",
            "label": "Threshold Testing",
            "weight": 33
          }
        ]
      }
    },
    {
      "id": "iris-ps-data",
      "type": "action",
      "position": {
        "x": 0,
        "y": 480
      },
      "data": {
        "label": "Start Data Collection",
        "actionType": "link_to_flow",
        "flowId": "flow-iris-data-collection",
        "flowNodeId": "iris-dc-intro",
        "preMessageEnabled": true,
        "preMessage": "*nods* Data Collection Protocol. Standard procedure - we'll be measuring your baseline responses. *prepares equipment* Try to remain still.",
        "preMessageTarget": "character",
        "preMessageSuppressLlm": false,
        "preDelay": 1,
        "postMessageEnabled": false
      }
    },
    {
      "id": "iris-ps-capacity",
      "type": "action",
      "position": {
        "x": 250,
        "y": 480
      },
      "data": {
        "label": "Start Capacity Study",
        "actionType": "link_to_flow",
        "flowId": "flow-iris-capacity-study",
        "flowNodeId": "iris-cs-intro",
        "preMessageEnabled": true,
        "preMessage": "*slight interest flickers* Capacity Study Protocol. *adjusts monitors* This requires extended observation. Your comfort is... noted but secondary.",
        "preMessageTarget": "character",
        "preMessageSuppressLlm": false,
        "preDelay": 1,
        "postMessageEnabled": false
      }
    },
    {
      "id": "iris-ps-threshold",
      "type": "action",
      "position": {
        "x": 500,
        "y": 480
      },
      "data": {
        "label": "Start Threshold Testing",
        "actionType": "link_to_flow",
        "flowId": "flow-iris-threshold-testing",
        "flowNodeId": "iris-tt-intro",
        "preMessageEnabled": true,
        "preMessage": "*a rare hint of anticipation* Threshold Testing Protocol. *checks equipment* This is where we push boundaries, Subject #47.",
        "preMessageTarget": "character",
        "preMessageSuppressLlm": false,
        "preDelay": 1,
        "postMessageEnabled": false
      }
    },
    {
      "id": "iris-ps-emo-start",
      "type": "action",
      "position": {
        "x": 275,
        "y": 250
      },
      "data": {
        "label": "Set Anxious",
        "actionType": "set_emotion",
        "emotion": "anxious"
      }
    }
  ],
  "edges": [
    {
      "id": "e1",
      "source": "iris-ps-trigger",
      "target": "iris-ps-selection"
    },
    {
      "id": "e3",
      "source": "iris-ps-random",
      "sourceHandle": "branch-0",
      "target": "iris-ps-data"
    },
    {
      "id": "e4",
      "source": "iris-ps-random",
      "sourceHandle": "branch-1",
      "target": "iris-ps-capacity"
    },
    {
      "id": "e5",
      "source": "iris-ps-random",
      "sourceHandle": "branch-2",
      "target": "iris-ps-threshold"
    },
    {
      "id": "e-iris-ps-selection-to-iris-ps-emo-start",
      "source": "iris-ps-selection",
      "target": "iris-ps-emo-start"
    },
    {
      "id": "e-iris-ps-emo-start-to-iris-ps-random",
      "source": "iris-ps-emo-start",
      "target": "iris-ps-random"
    }
  ]
}
